<script>
  function initMap() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(async (position) => {
        const data = {
          latitude: position.coords.latitude,
          longitude: position.coords.longitude,
          sheetId: '19p-kIdlPB7iXmMgiyVxPxv2CfJCAGDSgRF9keN1r4oM', // Replace with your Google Sheet ID
          apiKey: 'AIzaSyAyiQsONhgIlsACu5Q7Z3I7O_C3Md9QTEQ', // Replace with your Google API Key
        };

        const response = await fetch('https://sheets.googleapis.com/v4/spreadsheets/' + data.sheetId + ':batchUpdate?key=' + data.apiKey, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            requests: [{
              appendCells: {
                sheetId: 0, // The sheet ID for the first sheet in the document
                rows: [{
                  values: [
                    { userEnteredValue: { numberValue: data.latitude } },
                    { userEnteredValue: { numberValue: data.longitude } },
                  ],
                }],
                fields: 'userEnteredValue',
              },
            }],
          }),
        });

        if (response.ok) {
          console.log('Geolocation data saved successfully');
        } else {
          console.error('Failed to save geolocation data');
        }
      });
    } else {
      console.error('Geolocation is not supported by this browser.');
    }
  }
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAyiQsONhgIlsACu5Q7Z3I7O_C3Md9QTEQ&callback=initMap"></script>
